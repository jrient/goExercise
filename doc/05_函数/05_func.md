## 函数

[toc]

---

Go程序都是由各种函数组成的。函数是基本的代码块。

Go是编译型语言，所以函数的顺序无关紧要；鉴于可读性需求，最好把`main()`函数放在文件的前面，其他函数按照一定的逻辑顺序编写。

编写多个函数的主要目的是为了将一个需要多行代码的复杂问题拆分成一系列简单的任务来解决。并且同一个任务可以被调用多次，有助于代码的复用。

当函数执行到代码最后一行 `}` 或者 `return`语句的时候会退出。

`return` 语句可以带有零个或多个参数，这些参数会作为返回值供调用者使用。简单的`return`语句可以用来结束for循环，或者结束一个协程`goroutine`。

Go中有三种类型的函数：
- 普通带有名字的函数
- 匿名函数或者lambda函数
- 方法(Method)

除了 main() 、 init() 函数外，其他所有类型的函数可以带有**参数**和**返回值**，函数的参数、返回值、类型被统称为函数的签名。


简单的函数声明和调用：
```go
func fu(param1 string, param2 string) string {
    return param1 + param2
}

str := fu("aaa", "bbb")
```

在调用`fu`函数时，括号里传入的字符串时**实参**(argument)，这些值被**复制**给被调用的函数的**形参**(parmaeter)。函数一般在其他函数中调用，这个行为被称为函数调用(calling function)。函数能被多次调用，这些被调用的函数是按照调用顺序执行的。

示例：[greeting.go](05_src/greeting.go)

函数可以将其他函数的调用作为它的参数，只要被调用的函数的返回值个数、类型与调用函数所需的一致即可。例如：

```go
str2 := fu("aaa", fu("bbb", "ccc"))
```

函数重载(function overloading)是指可以编写多个同名函数，只要它们拥有不同的形参和返回值。在Go中**函数重载是不被允许的**。这将导致一个编译错误：
`funcName redeclared in this book, previous declaration at lineno`

因此，你必须给每一个函数一个(包内)唯一的名字。

如果需要声明一个在外部定义的函数，只需要给出函数名和函数签名，不需要给出函数体:
`func flushICache(begin, end uintptr) // implemented externally`

函数也可以以声明的方式被使用，作为一个函数类型：
`type binOp func(int, int) int`

函数的第一类值(first-class value)可以赋值给变量。这个变量知道自己保存的函数签名，不可以给他赋值另一个具有不同签名的函数值。

函数值(function value)之间可以互相比较，如果他们引用的是相同的函数或者都是nil的话，则认为他们是相同的函数。

函数不能在其他函数中声明(不能嵌套)，但是匿名函数可以打破这个限制。

Go函数没有泛型(generic， 指一个函数支持多种类新)的概念。不过大部分情况下可以通过接口(interface)或者反射(reflection)来实现类似的功能。

使用这些技术将导致代码更为复杂、性能更为低下，所以在非常注意性能的场合，最好是为每一个类型单独创建一个函数，而且代码可读性更强。